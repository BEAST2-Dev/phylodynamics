<beast version='2.0'
       namespace='import beast.base.math.distributions.Prior:beast.base.util:beast.base.math.TreeParser:phylodynamics.epidemiology:master.beast:beast.pkgmgmt:beast.base.core:beast.base.inference:beast.base.evolution.tree.coalescent:beast.pkgmgmt:beast.base.core:beast.base.inference.util:beast.evolution.nuc:beast.base.evolution.operator:beast.base.inference.operator:beast.base.evolution.sitemodel:beast.base.evolution.substitutionmodel:beast.base.evolution.likelihood:beast.base.inference.parameter:phylodynamics.epidemiology:beast.base.evolution.tree:beast.base.evolution.alignment'>

    <tree spec="beast.base.evolution.tree.TreeParser" id="tree" adjustTipHeights="false" offset="1" newick="(((22:2.3890722963752946,78:1.1797173779896428):0.6913726030837875,(((((((69:2.162226325612,27:4.606656991283511):0.011308420351793913,132:2.243995818400583):1.1018994763556158,137:1.7886251688059325):8.843075747836801,96:5.293071633171909):0.9133275576671291,((((52:3.559214727468257,(((((21:1.2657427374378152,129:6.920404106491723):1.1702961450462848,34:0.04616908870132441):3.8495176348956726,(31:1.6185722786341952,(15:4.889452178915562,19:6.004890529642001):1.098528281427324):2.0260868891156125):1.753543108204349,49:8.524562059986323):0.46387571665177063,(104:7.446786517295953,((30:2.9428658215166443,40:0.5713666098074306):3.227240412358354,(79:3.7766138505682463,100:1.8187442393176596):3.2870304056183155):4.168882010069488):2.8448014099959575):1.3901287732074454):0.6459765688281385,(105:5.536402832734938,11:6.91131613678416):0.7049138128647057):0.09174111356372538,3:3.7333702165762954):0.5471936796511576,(127:5.9981390678658055,57:1.8244495906352896):5.39868678611144):1.5874098295221275):0.828845665526821,(((((((44:6.252703743273495,74:0.7158316582251771):1.4673707916127103,71:8.053090890859234):0.3344878954693087,((70:3.3670865570333337,72:14.551853418676389):1.8880349588102892,112:1.1751049917147682):0.47825505109219435):1.0569273245141613,((16:5.714002545530711,25:0.17231732532539468):2.213632736598605,43:0.5439751519693576):4.948358374652377):0.6210745968892066,29:0.8189069148994701):2.0672482623908985,((88:2.703793496718232,97:3.003790044573707):0.3921759831861227,(64:14.699846527443922,(86:1.0273241147052534,(108:5.905095605834477,110:1.8883329835522051):2.48295542579317):1.240447385657438):2.2993014597380483):0.9989578314810297):1.9615671013661418,((((47:0.6063487821310716,((60:5.405926185694208,(94:0.9719582360271755,14:26.157103725909508):3.310913361770261):0.9282858142848873,(45:3.5389867211070403,120:5.31251092062152):2.1436952817072363):1.3462554148522798):1.241387968574812,(81:0.2607919541723476,58:1.916549062249672):28.12669626461314):0.3424982895437507,((116:1.588355023593186,((46:13.289978720894304,50:10.731434913452723):2.146715952069245,((67:7.688948188723371,65:3.701501673806172):0.1089066312315694,(41:3.070375949473828,98:9.333189584763126):2.7970024447848854):1.2079600284802936):2.79362219199591):0.8061610902730845,(106:0.05482729083848703,((85:0.4073038731747527,136:3.0198373421628872):1.1634673543503187,63:3.206625802809141):2.9843030157854162):2.0660222160975668):0.6286050919149968):0.27393589978305855,((((((((36:6.333652152850359,26:2.125380004221297):1.686851136441767,(75:0.26755898308844905,111:5.652894859227123):2.1641578151673233):1.1193983785785466,(124:7.994303402080957,134:7.989828792758233):1.4355634538897135):0.12584422457520006,76:1.1181380164821153):2.507182583789998,139:7.13572912916365):0.30938816538111436,(141:5.709150822427626,118:2.766060077790863):6.835715992240941):0.0744705116669575,((((133:0.4783995764976847,54:1.5383897428233517):2.482852697202423,((128:4.000839091342474,109:8.828976169062557):2.6078209023807943,119:3.764600765800946):0.06798399172580183):0.4999770120956164,((42:8.05812800050471,((89:1.048562036178991,(6:2.9090531751775686,91:4.018479461180355):2.8663893835423746):2.658604753994089,93:11.364764618887708):1.2513599981848067):0.9573481226797647,121:11.005561465203371):0.09278319555283154):0.43014527261351176,((113:1.6938937604114823,(84:0.27526829745780645,53:2.1895415824384887):1.5480643639970904):0.44459168168826935,(142:4.128083347759123,66:1.3504936342500322):0.028321124546378584):2.55050449268993):0.5442970847525084):0.06970056069959352,140:3.4097847157381835):0.5907335206573823):1.694398219453145):2.1793166633784247):1.6575169700602148,(99:4.315102661923212,(38:0.513997908999162,(138:2.6959521442614154,(((37:4.196228788228089,13:3.2571583302578624):2.4484619081846226,(114:4.604060978028656,48:8.349301590068166):9.714718793137125):0.06372146326097017,(135:17.67481549354928,61:4.230484648952942):1.3119413464145069):2.0541798183669737):3.977751228080642):0.9908285779051829):1.4409112597465865):0.21274397472850204):0.11467930348466249,(((((((((18:1.7239298552682971,123:2.9594875448172484):0.4592669429450549,(82:1.229254660417494,115:7.173330541154586):1.0970545218980394):4.20398394533758,126:7.878701161813019):1.4704071116592417,((((59:15.752876131600535,(2:11.88826005323113,10:13.863915202875491):1.877669434393507):0.6446164991548589,(17:1.3938637305600974,(((33:8.580877297282747,5:0.7259153761026305):3.112617054227975,80:6.074399401594864):0.23241618489482363,92:4.3901716005026294):5.553692410169653):0.15015932468987003):0.6790685122553928,39:10.242795768512655):0.4044070350694131,((95:1.7345859312766017,((101:1.9519931969819044,62:2.8023718883200512):0.09676979480969194,(90:4.024325872420338,12:12.211337626823177):0.564411559277934):2.256171637032173):0.6971399979314015,(125:11.167365459637022,((8:1.5775576184360034,28:10.337373264062894):1.9497332804253737,9:7.572221426265788):3.5336889629142014):2.810913360212016):2.1809877612937676):0.9546008154502807):0.023561884294649005,(23:1.2053072511457739,(56:3.6763803731193896,7:2.6006991118982796):0.18739431062627432):2.055915985819171):0.5548164286758528,77:1.4722197055751334):1.1378369353182638,(1:2.645118113968249,((102:16.366231626334862,117:9.430103749627044):0.6105273107802738,73:0.9709363807298281):0.8579702424486895):0.8581559668831398):1.6509678383594437,((20:0.3967198566331591,(87:1.122638992911142,(55:7.39266963892525,51:2.44049441136843):0.356961964641048):5.952936286583424):0.9827224963019283,(83:3.649693542526946,((((24:18.588083119717616,32:8.032193056911591):1.0698819132792199,107:1.3368937072555127):0.2752023603278744,((4:1.0365007889399749,130:5.613178585173198):0.7773903384635155,122:12.230775100080677):2.009205463172533):0.5037946489254903,((103:1.63601733912801,131:0.27614330856929925):4.77674445629577,68:1.961472373517278):5.968144304238443):1.8471127733846293):1.119803471359802):0.568066788199256):1.0757579770655035,35:1.6124427161129606):3.0648768251039877):1.3190755147519304;"/>

   <state id="state" storeEvery="1000">
        <stateNode spec="RealParameter" id="volz.n_S0" value="999"/>
        <stateNode spec="RealParameter" id="volz.R0" value="2.5"/>
        <stateNode spec="RealParameter" id="volz.gamma" value="0.30"/>
        <stateNode spec="RealParameter" id="volz.origin" value="40.7781111206"/>
    </state>

    <run spec="MCMC" id="mcmc" chainLength="10000000">

        <distribution spec="CompoundDistribution" id="posterior">
            <distribution id="coalescent" spec="Coalescent">
                <treeIntervals spec="beast.base.evolution.tree.TreeIntervals" id='treeIntervals'>
                    <tree idref="tree"/>
                </treeIntervals>
                
                <populationModel spec="SIRPopulationFunction" id='popFunc'>
                    <volzSIR spec="DeterministicCoalescentSIR" id="volzSIR" integrationStepCount='1001'>
                        <R0 idref="volz.R0"/>
                        <gamma idref="volz.gamma"/>
                        <n_S0 idref="volz.n_S0"/>
                        <origin idref="volz.origin"/>
                    </volzSIR>
                </populationModel>
                
            </distribution>
            
            <!-- Parameter priors -->
            <distribution spec='CompoundDistribution' id='parameterPriors'>
                <distribution spec='beast.base.inference.distribution.Prior' x="@volz.n_S0">
                    <distr spec='beast.base.inference.distribution.LogNormalDistributionModel' M="6" S="2"/>
                </distribution>
                <distribution spec='beast.base.inference.distribution.Prior' x="@volz.R0">
                    <distr spec="beast.base.inference.distribution.LogNormalDistributionModel"  M="0.5" S="2"/>
                </distribution>
                <distribution spec='beast.base.inference.distribution.Prior' x="@volz.gamma">
                    <distr spec='beast.base.inference.distribution.LogNormalDistributionModel' M="0.5" S="2"/>
                </distribution>
                <distribution spec='beast.base.inference.distribution.Prior' x="@volz.origin">
                    <distr spec="beast.base.inference.distribution.Uniform"  lower="0" upper="500"/>
                </distribution>
            </distribution>
            
        </distribution>


    <!-- OPERATORS! :D -->
    
      <operator id='S0' spec='ScaleOperator' scaleFactor="0.8" optimise="false" weight="1">
            <parameter idref="volz.n_S0"/>
      </operator>      
        
      <operator id='origin' spec='ScaleOperator' scaleFactor="0.8" optimise="false" weight="1">
          <parameter idref="volz.origin"/>
      </operator>

      <operator id='R0' spec='ScaleOperator' scaleFactor="0.8" optimise="false" weight="1">
          <parameter idref="volz.R0"/>
      </operator>

      <operator id='gamma' spec='ScaleOperator' scaleFactor="0.8" optimise="false" weight="1">
          <parameter idref="volz.gamma"/>
       </operator>


        <logger logEvery="1000" fileName="DeterCoalSIR_MASTERtree.log">
   	        <model idref='posterior'/>
            <log idref="posterior"/>
            <log idref="volz.n_S0"/>
            <log idref="volz.R0"/>
            <log idref="volz.gamma"/>
            <log idref="volz.origin"/>
            <log idref="volzSIR"/>
        </logger>

        <logger logEvery="1000">
            <model idref='posterior'/>
            <log idref="posterior"/>
            <log idref="volz.n_S0"/>
            <log idref="volz.R0"/>
            <log idref="volz.gamma"/>
            <log idref="volz.origin"/>
            <log idref="volzSIR"/>
        </logger>

    </run>

</beast>
